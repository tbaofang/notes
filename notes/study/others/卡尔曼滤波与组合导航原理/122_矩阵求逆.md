矩阵求逆引理:
对非奇异矩阵$A$及子矩阵$A_{11}, A_{22}$,若$A=\begin{bmatrix}
  A_{11} & A_{12} \\
  A_{21} & A_{22}
\end{bmatrix}$

则有: 
$$
\begin{aligned}
  A^{-1}&=\begin{bmatrix}
  A_{11}^{-1} + A_{11}^{-1}A_{12}(A_{22}- A_{21}A_{11}^{-1}A_{12})^{-1}A_{21}A_{11}^{-1} & -A_{11}^{-1}A_{12}(A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}  \\
  -(A_{22} - A_{21}A_{11}^{-1}A_{12})^{-1}A_{21}A_{11}^{-1} & (A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}
\end{bmatrix} \\ 
&=
\begin{bmatrix}
(A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1} & -(A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1}A_{12}A_{22}^{-1} \\ 
-A_{22}^{-1}A_{21}(A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1} & A_{22}^{-1} + A_{22}^{-1}A_{21}(A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1}A_{12}A_{22}^{-1}
\end{bmatrix}
\end{aligned}
$$

上式有两个等式(其中另外两个等式与该等式等价).

证明(验证):
$$
\begin{aligned}
  & A = \begin{bmatrix}
  I_n & 0 \\ A_{21}A_{11}^{-1} & I_m 
\end{bmatrix}
\begin{bmatrix}
  A_{11} & A_{12} \\ 0 & A_{22}-A_{21}A_{11}^{-1}A_{12}
\end{bmatrix} , \\
  &  \begin{bmatrix}
  I_n & 0 \\ A_{21}A_{11}^{-1} & I_m 
\end{bmatrix} ^{-1} = \begin{bmatrix}
  I_n & 0 \\ A_{21}A_{11}^{-1} & I_m
\end{bmatrix} \\
  &  \begin{bmatrix}
  A_{11} & A_{12} \\ 0 & A_{22}-A_{21}A_{11}^{-1}A_{12} 
\end{bmatrix} ^{-1} = \begin{bmatrix}
  A_{11}^{-1} & -A_{11}^{-1}A_{12}(A_{22} - A_{21}A_{11}^{-1}A_{12})^{-1} \\ 0 & (A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}
\end{bmatrix} \\
& A^{-1} = \begin{bmatrix}
  I_n & 0 \\ A_{21}A_{11}^{-1} & I_m
\end{bmatrix} 
\begin{bmatrix}
  A_{11}^{-1} & -A_{11}^{-1}A_{12}(A_{22} - A_{21}A_{11}^{-1}A_{12})^{-1} \\ 0 & (A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}
\end{bmatrix} = ...
\end{aligned}
$$

---

$$
\begin{aligned}
  P_{k} &=(P^{-1}_{k-1} + H^T_{k} R^{-1}_k H_k)^{-1} \\
  \hat{X}_k &= \hat{X}_{k-1} + P_k H^T_k R^{-1}_k(Z_k - H_k \hat{X}_{k-1})
\end{aligned}
$$

矩阵求逆引理:
$$
\begin{aligned}
  & (A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1} = A_{11}^{-1} + A_{11}^{-1}A_{12}(A_{22}- A_{21}A_{11}^{-1}A_{12})^{-1}A_{21}A_{11}^{-1} \\ 
  & A_{11}^{-1}A_{12}(A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1} = (A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1}A_{12}A_{22}^{-1}
\end{aligned}
$$

如令: $A_{11} = P_{k-1}^{-1}, A_{12}=-H_k^T, A_{22}=R_k, A_{21}=H_k$

则有:
$$
\begin{aligned}
  & P_k=(P_{k-1}^{-1}+H_k^T R_k^{-1} H_k)^{-1} = P_{k-1}^{-1} - P_{k-1} H_k^T(R_k + H_k P_{k-1} H_k^T)^{-1} H_k P_{k-1} \\
  & P_{k-1} H_k^T(R_k + H_k P_{k-1} H_k^T)^{-1} = (P_{k-1}^{-1} + H_k^T R_k^{-1} H_k)^{-1} H_k^T R_k^{-1} = P_k H_k^T R_k^{-1}
\end{aligned}
$$

最后得到递推最小二乘:
$$
\begin{aligned}
  & K_k = P_{k-1} H_k^T(H_k P_{k-1} H_k^T + R_k)^{-1} \\ 
  & \hat{X}_k = \hat{X}_{k-1} + K_k(Z_k - H_k \hat{X}_{k-1}) \\ 
  & P_k = (I - K_k H_k)P_{k-1}
\end{aligned}
$$

其中,第一个式子是增益矩阵,第二个是状态递推,第三个是方差阵递推.

---